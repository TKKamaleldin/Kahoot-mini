<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SMCS Ramadan Fawazeer</title>

<style>
body{margin:0;font-family:Arial;background:#111;color:#fff;overflow:hidden}

.screen{
position:fixed;inset:0;
display:flex;flex-direction:column;
align-items:center;justify-content:center;
gap:12px
}

.hidden{display:none!important}

input{padding:12px;font-size:18px;width:280px;border-radius:10px;border:none}
button{padding:12px 24px;font-size:18px;border:none;border-radius:12px;cursor:pointer}

#timer{
width:70px;height:70px;border-radius:50%;
background:#000;display:flex;align-items:center;
justify-content:center;font-size:28px
}

.answers{
width:100%;
height:55vh;
display:grid;
grid-template-columns:1fr 1fr
}

.ans{
font-size:22px;color:#fff;border:none
}

.red{background:#e21b3c}
.blue{background:#1368ce}
.yellow{background:#d89e00;color:#000}
.green{background:#26890c}

.card{
background:#1b1b1b;
padding:20px;
border-radius:16px;
box-shadow:0 10px 30px rgba(0,0,0,.35)
}

/* logo center */
.logo{
width:140px;
margin-bottom:10px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginScreen" class="screen">
  <img src="images/logo.png" class="logo">

  <div class="card">
    <h1>SMCS Ramadan Fawazeer</h1>

    <!-- ID فقط -->
    <input id="idInput" placeholder="Student ID"/>
    <button onclick="startGame()">Start</button>

    <div id="loginMsg"></div>
  </div>
</div>

<!-- QUESTION -->
<div id="questionScreen" class="screen hidden">
  <img src="images/logo.png" class="logo">

  <div id="timer">15</div>

  <h2 id="qText"></h2>

  <div class="answers">
    <button class="ans red" onclick="answer(0)"></button>
    <button class="ans blue" onclick="answer(1)"></button>
    <button class="ans yellow" onclick="answer(2)"></button>
    <button class="ans green" onclick="answer(3)"></button>
  </div>
</div>

<!-- RESULT -->
<div id="resultScreen" class="screen hidden">
  <div class="card">
    <h1 id="resultTitle"></h1>
    <div id="sendStatus"></div>
  </div>
</div>

<script>
const APPS_SCRIPT_URL =
"https://script.google.com/macros/s/AKfycbzpflfT37j0aWTZzpeUPVlbnu94mdIis1AuyWvHFJ6qv25SscFNutz_-1VVRboYLEKIPw/exec";

const question={
text:"In a time before laptops and late-night debugging… there was a man who is considered the father of theoretical computer science. Who was he?",
options:["Alan Turing","Charles Babbage","John von Neumann","Steve Jobs"],
correctIndex:0,
timeLimit:15
};

let userId="";
let startTime=0;
let timer=null;
let answered=false;

function startGame(){
userId=document.getElementById("idInput").value.trim();

if(!userId){
document.getElementById("loginMsg").textContent="Enter ID";
return;
}

show("questionScreen");
loadQuestion();
}

function loadQuestion(){
answered=false;
document.getElementById("qText").textContent=question.text;

const btns=document.querySelectorAll(".ans");
btns.forEach((b,i)=>b.textContent=question.options[i]);

startTime=Date.now();
startTimer(question.timeLimit);
}

function startTimer(sec){
let t=sec;
document.getElementById("timer").textContent=t;

timer=setInterval(()=>{
t--;
document.getElementById("timer").textContent=t;

if(t<=0){
clearInterval(timer);
finish(false,0,true);
}
},1000);
}

function answer(choice){
if(answered) return;
answered=true;
clearInterval(timer);

const elapsed=(Date.now()-startTime)/1000;
const correct=choice===question.correctIndex;
let score=Math.max(0,Math.floor((question.timeLimit-elapsed)*10));

finish(correct,score,false);
}

async function finish(correct,score,timedOut){
show("resultScreen");

document.getElementById("resultTitle").textContent=
timedOut?"Time's up!":correct?"Correct!":"Incorrect";

const status=document.getElementById("sendStatus");
status.textContent="Saving...";

try{
const fd=new FormData();
fd.append("id",userId);
fd.append("time","15");
fd.append("score",score);

await fetch(APPS_SCRIPT_URL,{method:"POST",body:fd});

status.textContent="Result saved ✅";
}catch{
status.textContent="Error saving result";
}
}

function show(id){
["loginScreen","questionScreen","resultScreen"].forEach(x=>{
document.getElementById(x).classList.toggle("hidden",x!==id);
});
}
</script>
</body>
</html>
