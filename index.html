<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SMCS Ramadan Fawazeer</title>

<style>
body{margin:0;font-family:Arial;background:#111;color:#fff;overflow:hidden}
.screen{position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px}
.hidden{display:none!important}
input{padding:12px;font-size:18px;width:280px;border-radius:10px;border:none}
button{padding:12px 24px;font-size:18px;border:none;border-radius:12px;cursor:pointer}
#timer{width:70px;height:70px;border-radius:50%;background:#000;display:flex;align-items:center;justify-content:center;font-size:28px}
.answers{width:100%;height:55vh;display:grid;grid-template-columns:1fr 1fr}
.ans{width:100%;height:100%;font-size:22px;color:#fff;border:none}
.red{background:#e21b3c}.blue{background:#1368ce}.yellow{background:#d89e00;color:#000}.green{background:#26890c}
.card{background:#1b1b1b;padding:20px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
.small{opacity:.85;font-size:14px}

/* logos */
.logos{
  position:absolute;
  top:15px;
  left:0;
  right:0;
  display:flex;
  justify-content:space-between;
  padding:0 18px;
  pointer-events:none;
}
.logo{width:70px;height:70px;object-fit:contain;opacity:.95}

/* ramadan bar */
.ramadan-bar{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.12);
  padding:10px 14px;
  border-radius:14px;
  margin-bottom:12px;
}
.ramadan-bar .title{font-size:20px;font-weight:700}
.ramadan-bar .icon{font-size:22px}

/* login background */
#loginScreen{
  background-image:url("./images/background.png");
  background-size:cover;
  background-position:center;
}
#loginScreen::before{
  content:"";
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.55);
}
#loginScreen .card{position:relative;z-index:1}
</style>
</head>

<body>

<div id="loginScreen" class="screen">

  <div class="logos">
    <img src="images/logo.png" class="logo">
    <img src="images/logo.png" class="logo">
  </div>

  <div class="card">
    <div class="ramadan-bar">
      <span class="icon">üåô</span>
      <span class="title">SMCS Ramadan Fawazeer</span>
      <span class="icon">ü´òüç≤</span>
    </div>

    <input id="nameInput" placeholder="Name"/>
    <input id="idInput" placeholder="Student ID"/>
    <button onclick="startGame()">Start</button>
    <div class="small" id="loginMsg"></div>
  </div>
</div>

<div id="questionScreen" class="screen hidden">

  <div class="logos">
    <img src="images/logo.png" class="logo">
    <img src="images/logo.png" class="logo">
  </div>

  <div style="display:flex;gap:14px;align-items:center">
    <div id="timer">20</div>
    <div id="scoreBox" class="small">Score: 0</div>
  </div>

  <h2 id="qText"></h2>

  <div class="answers">
    <button class="ans red" onclick="answer(0)"></button>
    <button class="ans blue" onclick="answer(1)"></button>
    <button class="ans yellow" onclick="answer(2)"></button>
    <button class="ans green" onclick="answer(3)"></button>
  </div>
</div>

<div id="resultScreen" class="screen hidden">
  <div class="card" style="text-align:center;min-width:320px">
    <h1 id="resultTitle"></h1>
    <div id="resultDetails"></div>
    <div class="small" id="sendStatus"></div>
  </div>
</div>

<script>

/* üîó Google Script */
const APPS_SCRIPT_URL =
"https://script.google.com/macros/s/AKfycbzLSEaLTsWLL2V2blXF3jAzl4nsGT_MsF6k4Y19RqgNYSoQQ5psxNPnGRIFThuFeDvcNQ/exec";

/* ‚ùì QUESTION */
const question = {
  text: `The first 5 questions:

1. In a time before laptops and late-night debugging‚Ä¶
there was a man who is considered the father of theoretical computer science.
Who was he?`,
  options: [
    "Alan Turing",
    "Charles Babbage",
    "John von Neumann",
    "Steve Jobs"
  ],
  correctIndex: 0,
  timeLimit: 20
};

let userId="", name="";
let startTime=0;
let timer=null;
let answered=false;

/* üîä sounds */
const sfx={
 login:new Audio("sounds/login.mp3"),
 timer:new Audio("sounds/timer.mp3"),
 correct:new Audio("sounds/correct.mp3"),
 incorrect:new Audio("sounds/incorrect.mp3"),
 timeup:new Audio("sounds/timeup.mp3"),
 points:new Audio("sounds/points.mp3")
};

let currentSound=null;
function playSound(a){
 if(currentSound){currentSound.pause();currentSound.currentTime=0;}
 currentSound=a;
 a.currentTime=0;
 a.play().catch(()=>{});
}

function startGame(){
 name=document.getElementById("nameInput").value.trim();
 userId=document.getElementById("idInput").value.trim();

 if(!name||!userId){
   document.getElementById("loginMsg").textContent="Enter name and ID";
   return;
 }

 playSound(sfx.login);
 show("questionScreen");
 loadQuestion();
}

function loadQuestion(){
 answered=false;
 document.getElementById("scoreBox").textContent="Score: 0";
 document.getElementById("qText").textContent=question.text;

 const btns=document.querySelectorAll(".ans");
 btns.forEach((b,i)=>b.textContent=question.options[i]);

 startTime=Date.now();
 startTimer(question.timeLimit);
}

function startTimer(sec){
 clearInterval(timer);
 let t=sec;
 document.getElementById("timer").textContent=t;

 timer=setInterval(()=>{
   t--;
   document.getElementById("timer").textContent=t;
   if(t<=5 && t>0) playSound(sfx.timer);

   if(t<=0){
     clearInterval(timer);
     playSound(sfx.timeup);
     finish(false,0,sec,true);
   }
 },1000);
}

function answer(choice){
 if(answered) return;
 answered=true;
 clearInterval(timer);

 const elapsed=(Date.now()-startTime)/1000;
 const correct=(choice===question.correctIndex);
 let score=Math.max(0,Math.floor((question.timeLimit-elapsed)*10));

 if(correct){
   playSound(sfx.correct);
   setTimeout(()=>playSound(sfx.points),200);
 } else {
   playSound(sfx.incorrect);
 }

 finish(correct,score,elapsed,false);
}

async function finish(correct,score,timeTaken,timedOut){
 show("resultScreen");

 document.getElementById("resultTitle").textContent=
 timedOut?"Time‚Äôs up!":correct?"Correct!":"Incorrect";

 document.getElementById("resultDetails").textContent=
 `Score: ${score} | Time: ${timeTaken.toFixed(1)}s`;

 const status=document.getElementById("sendStatus");
 status.textContent="Saving...";

 try{
   const fd=new FormData();
   fd.append("id",userId);
   fd.append("name",name);
   fd.append("score",score);
   fd.append("time",timeTaken.toFixed(1));

   await fetch(APPS_SCRIPT_URL,{method:"POST",body:fd});
   status.textContent="Result saved ‚úÖ";
 }catch{
   status.textContent="Could not save result ‚ùå";
 }
}

function show(id){
 ["loginScreen","questionScreen","resultScreen"].forEach(x=>{
   document.getElementById(x).classList.toggle("hidden",x!==id);
 });
}
</script>
</body>
</html>
